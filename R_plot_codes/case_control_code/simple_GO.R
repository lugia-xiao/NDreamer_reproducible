library(clusterProfiler)
library(org.Hs.eg.db)

# Define the list of genes
# ECCITE
gene_list <- c('TERT', 'KLRD1', 'FABP6', 'SCGB1B2P', 'KLHL31', 'NXPH3', 'AC098973.2', 'NUTM2B', 'CD207', 'SDK2', 'LRCOL1', 'RP11-55K13.1', 'PLA2G4B', 'BTNL2', 'ZNF503-AS1', 'PDE6A', 'RP5-827C21.6', 'RP11-981G7.2', 'TAL1', 'KRTAP5-9', 'AC115522.3', 'TFPI2', 'RP11-856M7.6', 'EDN1', 'AC021218.2', 'LINC00346', 'C22orf23', 'PGAM2', 'RP11-56B16.4', 'HTR2B', 'RP4-777O23.1', 'GPR17', 'C4orf47', 'FUT1', 'TNFRSF11B', 'CALML5', 'C1orf173', 'AC004069.2', 'MSTN', 'RND1', 'KCNQ2', 'EBF4', 'DCN', 'KRTAP5-7', 'RP11-113K21.4', 'RP11-503N18.1', 'UBXN10', 'RP11-481J2.2', 'ST18', 'GDNF', 'RP4-684O24.5', 'KIRREL3', 'RP11-46C24.5', 'RP11-700H6.1', 'AL136115.1', 'XCL1', 'KRT19', 'SLC10A1', 'OR13A1', 'APOBEC3A', 'RP11-339B21.13', 'MGAT3', 'CHRDL2', 'FAIM2', 'RP11-302M6.5', 'SNCB', 'RP11-169E6.1', 'TAS2R46', 'RP11-84D1.1', 'MAPK4', 'RP5-901A4.1', 'RP11-466A19.1', 'ACKR4', 'SCUBE3', 'RP11-94L15.2', 'IFNL1', 'SNAP25', 'LINC00284', 'C21orf62', 'CNGA1', 'EMILIN3', 'RP11-3D4.3', 'RP11-159H22.2', 'ENTPD2', 'CD300E', 'IFNB1', 'CCDC147', 'OCSTAMP', 'RP3-455J7.4', 'C17orf66', 'PRRX1', 'GUCY2F', 'RP11-544A12.8', 'EPHB1', 'PRR18', 'COMP', 'RP11-192P3.4', 'RP5-1098D14.1', 'LINC00028', 'RP11-158I3.3', 'RP11-818F20.5', 'HYAL1', 'PSORS1C1', 'TTTY10', 'RP5-1195D24.1', 'C9orf163', 'RP11-211C9.1', 'RP11-221N13.3', 'CTC-575N7.1', 'RP11-11C20.3', 'HLA-DQA2', 'RP11-1020A11.2', 'LINC00484', 'KRT23', 'CD300LG', 'RP11-651P23.5', 'RANBP3L', 'GFRA3', 'CD1C', 'RP11-298O21.2', 'RP11-292E2.4', 'RP4-799D16.1', 'GULP1', 'RP11-168G16.2', 'RP11-307L14.1', 'RP11-452H21.4', 'RP11-333I13.1', 'TRPC3', 'RP11-230C9.2', 'LXN', 'RP11-727F15.12', 'CLDN9', 'RP11-486M23.2', 'CCL4L1', 'RP11-74E22.3', 'THEM5', 'RP6-109B7.5', 'RP11-389C8.3', 'INHBA', 'PCDHGB6', 'AC068610.3', 'TMEM110-MUSTN1', 'RP11-538D16.2', 'RP11-369E15.4', 'AL121578.2', 'TGM7', 'AC109828.1', 'CALD1', 'HIST1H4I', 'UNC80', 'TAC3', 'CCL3L1', 'RP11-685M7.3', 'OLIG1', 'LINC01119', 'RP11-428J1.4', 'CTD-2331H12.7', 'CTD-3234P18.2', 'PCDHGA4', 'SERPINB10', 'LINC00211', 'HTN1', 'CHMP4C', 'PDIA2', 'AC005481.5', 'AL590708.2', 'LINC00621', 'FAM65C', 'AC079466.1', 'CCDC160', 'ZNF763.1', 'SLC5A2', 'VNN1', 'RP11-394I13.3', 'RP11-184M15.1', 'EXTL1', 'TMEM163', 'RP11-597D13.9', 'COL12A1', 'LGALS2', 'RP3-439F8.1', 'MMP1', 'CYR61', 'DNAAF1', 'NEXN', 'ZNF667-AS1', 'RP11-122G18.8', 'TSSK4', 'TLL2', 'KLHL38', 'RP11-157D23.2', 'KIT', 'NNMT', 'CTD-2033A16.1', 'AP001628.6', 'CTD-2636A23.2', 'AP001044.2', 'hsa-mir-335', 'AC114730.2', 'CMKLR1')
dataset_name<-"ECCITE"

# t1d
gene_list<-c('ENSG00000261025', 'ENSG00000261369', 'ENSG00000249870', 'ENSG00000283434', 'ENSG00000176358', 'ENSG00000174450', 'ENSG00000182333', 'ENSG00000228427', 'ENSG00000257022', 'ENSG00000236961', 'ENSG00000266588', 'ENSG00000249857', 'ENSG00000259362', 'ENSG00000258670', 'ENSG00000279006', 'ENSG00000259947', 'ENSG00000269954', 'ENSG00000226510', 'ENSG00000267480', 'ENSG00000197309', 'ENSG00000243062', 'ENSG00000260488', 'ENSG00000231628', 'ENSG00000260792', 'ENSG00000239593', 'ENSG00000229869', 'ENSG00000282041', 'ENSG00000270919', 'ENSG00000284600', 'ENSG00000214039', 'ENSG00000142319', 'ENSG00000229495', 'ENSG00000259792', 'ENSG00000249500', 'ENSG00000125998', 'ENSG00000233968', 'ENSG00000214711', 'ENSG00000225334', 'ENSG00000177800', 'ENSG00000224935', 'ENSG00000100012', 'ENSG00000259711', 'ENSG00000204572', 'ENSG00000243766', 'ENSG00000222044', 'ENSG00000204613', 'ENSG00000228482', 'ENSG00000222000', 'ENSG00000254911', 'ENSG00000265400', 'ENSG00000274515', 'ENSG00000243910', 'ENSG00000172673', 'ENSG00000254894', 'ENSG00000230317', 'ENSG00000261872', 'ENSG00000280418', 'ENSG00000170948', 'ENSG00000253515', 'ENSG00000234223', 'ENSG00000121594', 'ENSG00000224481', 'ENSG00000256407', 'ENSG00000276087', 'ENSG00000259475', 'ENSG00000180535', 'ENSG00000275197', 'ENSG00000213416', 'ENSG00000228278', 'ENSG00000258811', 'ENSG00000198670', 'ENSG00000180383', 'ENSG00000133067', 'ENSG00000273706', 'ENSG00000186090', 'ENSG00000170788', 'ENSG00000245148', 'ENSG00000072315', 'ENSG00000268756', 'ENSG00000160838', 'ENSG00000168135', 'ENSG00000248318', 'ENSG00000260145', 'ENSG00000259823', 'ENSG00000147873', 'ENSG00000258260', 'ENSG00000231441', 'ENSG00000234864', 'ENSG00000235958', 'ENSG00000223901', 'ENSG00000203364', 'ENSG00000171611', 'ENSG00000230782', 'ENSG00000258790', 'ENSG00000185203', 'ENSG00000267665', 'ENSG00000238273', 'ENSG00000246422', 'ENSG00000267311', 'ENSG00000215009', 'ENSG00000253406', 'ENSG00000163012', 'ENSG00000254997', 'ENSG00000184492', 'ENSG00000258092', 'ENSG00000205927', 'ENSG00000254303', 'ENSG00000261195', 'ENSG00000223511', 'ENSG00000269600', 'ENSG00000229791', 'ENSG00000260131', 'ENSG00000166091', 'ENSG00000267117', 'ENSG00000154478', 'ENSG00000276292', 'ENSG00000269656', 'ENSG00000215475', 'ENSG00000224817', 'ENSG00000268257', 'ENSG00000140488', 'ENSG00000251688', 'ENSG00000034971', 'ENSG00000178107', 'ENSG00000272153', 'ENSG00000248268', 'ENSG00000223522', 'ENSG00000109674', 'ENSG00000259250', 'ENSG00000168269', 'ENSG00000224649', 'ENSG00000215692', 'ENSG00000188152', 'ENSG00000108839', 'ENSG00000261668', 'ENSG00000254338', 'ENSG00000237331', 'ENSG00000105205', 'ENSG00000157766', 'ENSG00000251171', 'ENSG00000183090', 'ENSG00000149575', 'ENSG00000272236', 'ENSG00000113520', 'ENSG00000269489', 'ENSG00000228352', 'ENSG00000259527', 'ENSG00000145794', 'ENSG00000227352', 'ENSG00000261231', 'ENSG00000269533', 'ENSG00000204010', 'ENSG00000250910', 'ENSG00000258451', 'ENSG00000112232', 'ENSG00000261159', 'ENSG00000182450', 'ENSG00000250049', 'ENSG00000258675', 'ENSG00000272130', 'ENSG00000238133', 'ENSG00000273153', 'ENSG00000265096', 'ENSG00000173250', 'ENSG00000254762', 'ENSG00000237372', 'ENSG00000215784', 'ENSG00000284952', 'ENSG00000225778', 'ENSG00000255476', 'ENSG00000273044', 'ENSG00000235066', 'ENSG00000140505', 'ENSG00000271314', 'ENSG00000183470', 'ENSG00000272078', 'ENSG00000049247', 'ENSG00000187690', 'ENSG00000263698', 'ENSG00000228973', 'ENSG00000223999', 'ENSG00000235293', 'ENSG00000187980', 'ENSG00000256746', 'ENSG00000248701', 'ENSG00000244998', 'ENSG00000274191', 'ENSG00000273650', 'ENSG00000268560', 'ENSG00000167094', 'ENSG00000111404', 'ENSG00000261020', 'ENSG00000272703', 'ENSG00000255327', 'ENSG00000122728', 'ENSG00000261392', 'ENSG00000168546', 'ENSG00000246331', 'ENSG00000181617', 'ENSG00000261797')
gene_list<-bitr(gene_list, fromType = "ENSEMBL", toType = "SYMBOL", OrgDb = org.Hs.eg.db)$SYMBOL
dataset_name<-"T1D"

gene_list<-c('CDK5R2', 'AL137078.2', 'AC022690.2', 'AL136322.1', 'AL157709.1', 'AC133785.1', 'OR10D3', 'AC090774.2', 'AC083864.4', 'AC010163.1', 'AC005104.1', 'CLLU1OS', 'AC084167.1', 'AC021236.1', 'AC067945.2', 'AL022314.1', 'AC117422.1', 'EGFLAM-AS3', 'IGLV1-47', 'LRIT2', 'RDH8', 'AL137804.1', 'AC136424.1', 'AC078889.1', 'AC090164.2', 'HCG21', 'IGHV4-59', 'AC073359.2', 'AP004609.1', 'AL499627.2', 'XAGE5', 'ZCCHC23', 'AC013701.2', 'AC116914.1', 'AC055716.3', 'AC090821.2', 'H2AFB3', 'IGLJCOR18', 'AL132719.1', 'IGLV5-45', 'IGHV3-48', 'AC244102.3', 'IGHV3-33', 'AF106564.1', 'LINC02544', 'SPAG11A', 'PAGE3', 'AL138831.2', 'AL137802.1', 'LINC01259', 'AP000289.1', 'AC008125.1', 'TRAV29DV5', 'LHX3', 'IL17C', 'LINC01192', 'PRAMEF10', 'TRBV18', 'AC084211.1', 'AL358154.1', 'AC087749.2', 'SLC6A5', 'AL035250.1', 'AC008060.2', 'AC012615.4', 'TEX26', 'AC109479.1', 'AC078880.4', 'AC093677.3', 'SERTM2', 'AP003025.2', 'LCE1C', 'TRBV21-1', 'LINC02052', 'Z97198.1', 'AC069061.2', 'AC091493.1', 'HMSD', 'SLN', 'GIMD1', 'AC068020.1', 'TRBV7-2', 'C1orf94', 'AC087612.1', 'LINC02670', 'OR5V1', 'APOF', 'CCL26', 'AC097359.3', 'AC097468.1', 'AC107027.1', 'AL359258.1', 'IL21', 'DAZ4', 'LINC01929', 'AC006364.1', 'LINC02396', 'AC007403.1', 'HBE1', 'AC105402.3', 'AL360175.1', 'AC016168.4', 'LINC01035', 'AC005014.3', 'AC004946.2', 'IL22', 'AC025278.1', 'TRBV6-5', 'COL5A1-AS1', 'AC005614.1', 'PHGR1', 'LINC02388', 'AP005121.1', 'HIGD1B', 'TRAV36DV7', 'SPRR2A', 'IL13', 'AC025280.2', 'AC015819.1', 'AL358075.2', 'IGKV3-15', 'LINC01163', 'AP000820.2', 'AC137735.3', 'Z99289.1', 'AC046168.1', 'MT1HL1', 'KRT2', 'AC093423.2', 'LINC01918', 'IGLV2-11', 'AC092811.1', 'PLA2G5', 'IGKV1-16', 'AADACL3', 'AC008591.1', 'AC108105.1', 'AP000802.1', 'AC025187.1', 'IL17A', 'KRT73', 'FABP2', 'AC122710.1', 'LINC01478', 'KRTAP17-1', 'AL844892.1', 'RYR2', 'AL512655.1', 'AC026320.1', 'AC004585.1', 'TRH', 'HIST1H4K', 'LGALS9C', 'AC129915.3', 'LINC01592', 'AC108865.1', 'AC009630.4', 'GC', 'IGLV3-10', 'MIP', 'CCDC13-AS1', 'ACTG2', 'AL672032.1', 'LINC02824', 'H3F3C', 'AC140118.2', 'OPCML', 'TRAV14DV4', 'AC090531.1', 'HAND2', 'LINC00707', 'CEMIP', 'AC018755.1', 'AC114977.1', 'AC140847.1', 'SRRM4', 'AL355388.3', 'ADRA1D', 'TUBB1', 'AL162408.1', 'PCDH11X', 'KCNMA1-AS3', 'CEACAM5', 'ACTA1', 'LINC02325', 'TUBA8', 'TCHH', 'NTS', 'LINC00443', 'LINGO3', 'MATN1', 'AL512631.1', 'NKAIN2', 'CDC20B', 'IGHV3-23', 'MT1B', 'IGKV3-11', 'CFAP74', 'CDH19', 'LINC00578')
dataset_name<-"Kidney"

gene_list<-c()
dataset_name<-"AD"

print(length(gene_list))
gene_list<-gene_list[1:100]

# Convert gene symbols to Entrez IDs
entrez_ids <- bitr(gene_list, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)

# Check if there are unmapped genes
if (nrow(entrez_ids) < length(gene_list)) {
  cat("Some genes could not be mapped to Entrez IDs:\n")
  unmapped_genes <- setdiff(gene_list, entrez_ids$SYMBOL)
  print(unmapped_genes)
}

# Perform GO enrichment analysis
go_enrichment <- enrichGO(
  gene          = entrez_ids$ENTREZID,
  OrgDb         = org.Hs.eg.db,
  keyType       = "ENTREZID",
  ont           = "ALL",       # Choose "BP", "CC", or "MF" for specific categories
  pAdjustMethod = "BH",
  pvalueCutoff  = 0.05,
  qvalueCutoff  = 0.2
)

# Display the results
head(go_enrichment)

# Visualize the results (e.g., barplot)
if (nrow(go_enrichment) > 0) {
  barplot(go_enrichment, showCategory = 10, title = dataset_name)
} else {
  cat("No significant GO terms found.\n")
}